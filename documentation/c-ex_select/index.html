
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../b-ex_schemas/">
      
      
        <link rel="next" href="../d-ex_insert_delete/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.10">
    
    
      
        <title>Select Queries - doctable</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.fad675c6.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#select-queries" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="doctable" class="md-header__button md-logo" aria-label="doctable" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            doctable
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Select Queries
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/devincornell/doctable" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    devincornell/doctable
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="doctable" class="md-nav__button md-logo" aria-label="doctable" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    doctable
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/devincornell/doctable" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    devincornell/doctable
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation and Change Log
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Documentation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../a-ex_basics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../b-ex_schemas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Table Schemas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Select Queries
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Select Queries
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#define-a-demonstration-schema" class="md-nav__link">
    <span class="md-ellipsis">
      Define a demonstration schema
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#insert-test-data" class="md-nav__link">
    <span class="md-ellipsis">
      Insert test data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#two-interfaces-connectquery-and-tablequery" class="md-nav__link">
    <span class="md-ellipsis">
      Two Interfaces: ConnectQuery and TableQuery
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#connectquery-basics" class="md-nav__link">
    <span class="md-ellipsis">
      ConnectQuery Basics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ConnectQuery Basics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#selecting-specific-columns" class="md-nav__link">
    <span class="md-ellipsis">
      Selecting Specific Columns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#working-with-query-results" class="md-nav__link">
    <span class="md-ellipsis">
      Working with Query Results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conditional-select-statements" class="md-nav__link">
    <span class="md-ellipsis">
      Conditional Select Statements
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#column-operators" class="md-nav__link">
    <span class="md-ellipsis">
      Column Operators
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-parameters-order-by-group-by-limit-offset" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Parameters: Order By, Group By, Limit, Offset
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Additional Parameters: Order By, Group By, Limit, Offset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#order-by-and-limits" class="md-nav__link">
    <span class="md-ellipsis">
      Order By and Limits
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grouping-and-column-operators" class="md-nav__link">
    <span class="md-ellipsis">
      Grouping and Column Operators
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#offset-and-selecting-chunks" class="md-nav__link">
    <span class="md-ellipsis">
      Offset and Selecting Chunks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tablequery-basics" class="md-nav__link">
    <span class="md-ellipsis">
      TableQuery Basics
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../d-ex_insert_delete/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Insert and Delete Queries
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../e-iris_example/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Iris Vignette
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../ex_basics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basics of doctable
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../ex_insert_delete/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Insert and Delete Queries with doctable
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../ex_schemas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Table Schemas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../ex_select/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Select Queries with doctable
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../iris_example/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Iris example
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Legacy documentation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Legacy documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../legacy_documentation/dataclass_example/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dataclass Schema Example
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../legacy_documentation/dataclass_vignette_advanced/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Advanced dataclass schema vignette
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../legacy_documentation/depric_vignette_newsgroups/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NewsGroups Dataset Vignette
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../legacy_documentation/distributed_basics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Distribute Parallel Processing Basics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../legacy_documentation/doctable_basics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DocTable Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../legacy_documentation/doctable_bootstrap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Document Bootstrapping Examples
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../legacy_documentation/doctable_concurrency/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Concurrent Database Connections
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../legacy_documentation/doctable_connectengine/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Manage SQL Connections with DocTable
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../legacy_documentation/doctable_file_column_types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DocTable File Column Types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../legacy_documentation/doctable_insert_delete/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DocTable Examples: Insert and Delete
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../legacy_documentation/doctable_multitable/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Example: Multiple Tables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../legacy_documentation/doctable_parsetreedoc_column/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ParseTreeDoc Column Types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../legacy_documentation/doctable_picklefile/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DocTable Example: Pickle and Text Files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../legacy_documentation/doctable_schema/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DocTable Schemas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../legacy_documentation/doctable_schema_dataclass/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DocTable Example: Schemas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../legacy_documentation/doctable_schema_legacy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DocTable Schemas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../legacy_documentation/doctable_select/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DocTable Examples: Select
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../legacy_documentation/doctable_update/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DocTable Examples: Update
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../legacy_documentation/example_nss_1_intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vignette 1: Storing Document Metadata
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../legacy_documentation/example_nss_2_parsing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vignette 2: Storing Document Text
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../legacy_documentation/example_nss_3_parsetrees/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vignette 3: Storing Parsed Documents
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../legacy_documentation/example_nss_intro_dataclass/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Example 1: US National Security Strategy Document Corpus
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../legacy_documentation/legacy_adv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DocTable (slightly more) Advanced Example
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../legacy_documentation/legacy_simple/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DocTable Simple Example
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../legacy_documentation/parse_parsepipeline/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ParsePipeline Basics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../legacy_documentation/parse_parsetrees/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Working with doctable Parsetrees
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#define-a-demonstration-schema" class="md-nav__link">
    <span class="md-ellipsis">
      Define a demonstration schema
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#insert-test-data" class="md-nav__link">
    <span class="md-ellipsis">
      Insert test data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#two-interfaces-connectquery-and-tablequery" class="md-nav__link">
    <span class="md-ellipsis">
      Two Interfaces: ConnectQuery and TableQuery
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#connectquery-basics" class="md-nav__link">
    <span class="md-ellipsis">
      ConnectQuery Basics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ConnectQuery Basics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#selecting-specific-columns" class="md-nav__link">
    <span class="md-ellipsis">
      Selecting Specific Columns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#working-with-query-results" class="md-nav__link">
    <span class="md-ellipsis">
      Working with Query Results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conditional-select-statements" class="md-nav__link">
    <span class="md-ellipsis">
      Conditional Select Statements
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#column-operators" class="md-nav__link">
    <span class="md-ellipsis">
      Column Operators
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-parameters-order-by-group-by-limit-offset" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Parameters: Order By, Group By, Limit, Offset
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Additional Parameters: Order By, Group By, Limit, Offset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#order-by-and-limits" class="md-nav__link">
    <span class="md-ellipsis">
      Order By and Limits
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grouping-and-column-operators" class="md-nav__link">
    <span class="md-ellipsis">
      Grouping and Column Operators
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#offset-and-selecting-chunks" class="md-nav__link">
    <span class="md-ellipsis">
      Offset and Selecting Chunks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tablequery-basics" class="md-nav__link">
    <span class="md-ellipsis">
      TableQuery Basics
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="select-queries">Select Queries</h1>
<p>In this document I will describe the interface for performing select queries with <code>doctable</code>. </p>
<pre><code class="language-python">
import pandas as pd
import numpy as np
import typing

import sys
sys.path.append('..')
import doctable
</code></pre>
<h4 id="define-a-demonstration-schema">Define a demonstration schema</h4>
<p>The very first step is to define a table schema that will be appropriate for our examples. This table includes the typical <code>id</code> column (the first column, specified by <code>order=0</code>), as well as string, integer, and boolean attributes. The object used to specify the schema is called a <em>container</em>, and I will use that terminology as we go.</p>
<pre><code class="language-python">@doctable.table_schema
class Record:
    name: str = doctable.Column(column_args=doctable.ColumnArgs(nullable=False, unique=True))
    age: int = doctable.Column()
    is_old: bool = doctable.Column()

    id: int = doctable.Column(
        column_args=doctable.ColumnArgs(
            order = 0, 
            primary_key=True, 
            autoincrement=True
        ),
    )

core = doctable.ConnectCore.open(target=':memory:', dialect='sqlite', echo=True)

with core.begin_ddl() as ddl:
    rtab = ddl.create_table_if_not_exists(container_type=Record)
</code></pre>
<pre><code>2023-11-13 08:38:32,059 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:32,060 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("Record")
2023-11-13 08:38:32,060 INFO sqlalchemy.engine.Engine [raw sql] ()
2023-11-13 08:38:32,061 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("Record")
2023-11-13 08:38:32,062 INFO sqlalchemy.engine.Engine [raw sql] ()
2023-11-13 08:38:32,063 INFO sqlalchemy.engine.Engine 
CREATE TABLE "Record" (
    id INTEGER, 
    age INTEGER, 
    is_old INTEGER, 
    name VARCHAR NOT NULL, 
    PRIMARY KEY (id), 
    UNIQUE (name)
)


2023-11-13 08:38:32,063 INFO sqlalchemy.engine.Engine [no key 0.00039s] ()
2023-11-13 08:38:32,064 INFO sqlalchemy.engine.Engine COMMIT
</code></pre>
<h4 id="insert-test-data">Insert test data</h4>
<p>We insert the test data using the <code>TableQuery</code> interface. Because this document is about select queries, feel free to look over this for now. I show the contents of the table as a dataframe below. The interface for doing this will be covered later in this document.</p>
<pre><code class="language-python">import random
random.seed(0)

new_records: typing.List[Record] = list()
for i in range(10):
    age = int(random.random()*100) # number in [0,1]
    is_old = age &gt; 50
    new_records.append(Record(name='user_'+str(i), age=age, is_old=is_old))

# insert new records
with rtab.query() as q:
    print(q.insert_multi(new_records))

# dataframe select (for example purposes - .df() will be covered later)
with core.query() as q:
    r = q.select(rtab.all_cols()).df()
r
</code></pre>
<pre><code>2023-11-13 08:38:32,104 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:32,104 INFO sqlalchemy.engine.Engine INSERT OR FAIL INTO "Record" (age, is_old, name) VALUES (?, ?, ?)
2023-11-13 08:38:32,105 INFO sqlalchemy.engine.Engine [generated in 0.00140s] [(84, True, 'user_0'), (75, True, 'user_1'), (42, False, 'user_2'), (25, False, 'user_3'), (51, True, 'user_4'), (40, False, 'user_5'), (78, True, 'user_6'), (30, False, 'user_7'), (47, False, 'user_8'), (58, True, 'user_9')]
&lt;sqlalchemy.engine.cursor.CursorResult object at 0x7feef3d133f0&gt;
2023-11-13 08:38:32,106 INFO sqlalchemy.engine.Engine COMMIT
2023-11-13 08:38:32,109 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:32,109 INFO sqlalchemy.engine.Engine SELECT "Record".id, "Record".age, "Record".is_old, "Record".name 
FROM "Record"
2023-11-13 08:38:32,109 INFO sqlalchemy.engine.Engine [generated in 0.00102s] ()
2023-11-13 08:38:32,112 INFO sqlalchemy.engine.Engine COMMIT
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>age</th>
      <th>is_old</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>84</td>
      <td>1</td>
      <td>user_0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>75</td>
      <td>1</td>
      <td>user_1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>42</td>
      <td>0</td>
      <td>user_2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>25</td>
      <td>0</td>
      <td>user_3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>51</td>
      <td>1</td>
      <td>user_4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>40</td>
      <td>0</td>
      <td>user_5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>78</td>
      <td>1</td>
      <td>user_6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>30</td>
      <td>0</td>
      <td>user_7</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9</td>
      <td>47</td>
      <td>0</td>
      <td>user_8</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>58</td>
      <td>1</td>
      <td>user_9</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="two-interfaces-connectquery-and-tablequery">Two Interfaces: <code>ConnectQuery</code> and <code>TableQuery</code></h2>
<p>There are two interfaces for performing queries: <code>ConnectQuery</code> and <code>TableQuery</code>. </p>
<ul>
<li>
<p><strong><code>ConnectQuery</code></strong> table-agnostic interface for querying any table in any result format.</p>
</li>
<li>
<p><strong><code>TableQuery</code></strong> table-specific interface for querying a specific table. Insert and select from container objects used to define the schema.</p>
</li>
</ul>
<pre><code class="language-python"># ConnectQuery - table agnostic
with core.query() as q:
    print(type(q))

# TableQuery - queries are relative to specific 
# table, results appear as container objects
with rtab.query() as q:
    print(type(q))
</code></pre>
<pre><code>&lt;class 'doctable.query.connectquery.ConnectQuery'&gt;
&lt;class 'doctable.query.tablequery.TableQuery'&gt;
</code></pre>
<h2 id="connectquery-basics"><code>ConnectQuery</code> Basics</h2>
<p>First I will discuss the <code>ConnectQuery</code> interface, which is created via the <code>ConnectCore.query()</code> method. This object maintains a database connection, and, when used as a context manager, will commit all changes upon exit. It is fine to use the <code>ConnectQuery</code> object without a context manager for queries that do not require commits.</p>
<p>This example is the most basic select query we can execute. Note that <code>ConnectQuery</code> methods are table-agnostic, so we must specify columns to be selected - in this case, we provide <code>rtab.all_cols()</code> to specify that we want to query all columns from the <code>Record</code> table. It returns a <code>sqlalchemy.CursorResult</code> object that we will discuss later.</p>
<pre><code class="language-python">core.query().select(rtab.all_cols())
</code></pre>
<pre><code>2023-11-13 08:38:32,204 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:32,205 INFO sqlalchemy.engine.Engine SELECT "Record".id, "Record".age, "Record".is_old, "Record".name 
FROM "Record"
2023-11-13 08:38:32,205 INFO sqlalchemy.engine.Engine [cached since 0.09654s ago] ()





&lt;sqlalchemy.engine.cursor.CursorResult at 0x7feef3d88130&gt;
</code></pre>
<h3 id="selecting-specific-columns">Selecting Specific Columns</h3>
<p>In many cases, you would not want to select all columns from a given table - for this reason, there are several methods you can use to specify the desired columns. In addition to <code>.all_cols()</code> in the above snippet, you may use any of these methods.</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>.all_cols()</code></td>
<td>specify that we want all columns</td>
</tr>
<tr>
<td><code>.cols('col1', 'col2')</code></td>
<td>specify set of columns</td>
</tr>
<tr>
<td><code>table['col1']</code></td>
<td>specify single column</td>
</tr>
<tr>
<td><code>table[['col1', 'col2']]</code></td>
<td>specify multiple columns</td>
</tr>
<tr>
<td><code>table['col1':'col3']</code></td>
<td>specify sequential range of columns</td>
</tr>
</tbody>
</table>
<pre><code class="language-python"># select all columns
rtab.all_cols()
</code></pre>
<pre><code>[Column('id', Integer(), table=&lt;Record&gt;, primary_key=True),
 Column('age', Integer(), table=&lt;Record&gt;),
 Column('is_old', Integer(), table=&lt;Record&gt;),
 Column('name', String(), table=&lt;Record&gt;, nullable=False)]
</code></pre>
<pre><code class="language-python"># .cols method
rtab.cols('id', 'name')
</code></pre>
<pre><code>[Column('id', Integer(), table=&lt;Record&gt;, primary_key=True),
 Column('name', String(), table=&lt;Record&gt;, nullable=False)]
</code></pre>
<pre><code class="language-python"># single-column subscript
rtab['age']
</code></pre>
<pre><code>Column('age', Integer(), table=&lt;Record&gt;)
</code></pre>
<pre><code class="language-python"># list of columns
rtab[['id','is_old']]
</code></pre>
<pre><code>[Column('id', Integer(), table=&lt;Record&gt;, primary_key=True),
 Column('is_old', Integer(), table=&lt;Record&gt;)]
</code></pre>
<pre><code class="language-python"># slice select
rtab['id':'is_old']
</code></pre>
<pre><code>[Column('id', Integer(), table=&lt;Record&gt;, primary_key=True),
 Column('age', Integer(), table=&lt;Record&gt;),
 Column('is_old', Integer(), table=&lt;Record&gt;)]
</code></pre>
<p>Note that the <code>.select()</code> method requires a list of columns, so we can combine these methods by combining the lists they return. Obviously, the order matters for the returned values.</p>
<pre><code class="language-python">rtab.cols('id','is_old') + [rtab['name']]
</code></pre>
<pre><code>[Column('id', Integer(), table=&lt;Record&gt;, primary_key=True),
 Column('is_old', Integer(), table=&lt;Record&gt;),
 Column('name', String(), table=&lt;Record&gt;, nullable=False)]
</code></pre>
<p>The <code>.select()</code> method always accepts a list of columns, so be sure to wrap single-column selections in a list.</p>
<pre><code class="language-python">core.query().select([rtab['name']])
</code></pre>
<pre><code>2023-11-13 08:38:32,540 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:32,541 INFO sqlalchemy.engine.Engine SELECT "Record".name 
FROM "Record"
2023-11-13 08:38:32,542 INFO sqlalchemy.engine.Engine [generated in 0.00130s] ()





&lt;sqlalchemy.engine.cursor.CursorResult at 0x7feef3d12f90&gt;
</code></pre>
<pre><code class="language-python">core.query().select(rtab.cols('id','is_old') + [rtab['name']])
</code></pre>
<pre><code>2023-11-13 08:38:32,589 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:32,590 INFO sqlalchemy.engine.Engine SELECT "Record".id, "Record".is_old, "Record".name 
FROM "Record"
2023-11-13 08:38:32,590 INFO sqlalchemy.engine.Engine [generated in 0.00142s] ()





&lt;sqlalchemy.engine.cursor.CursorResult at 0x7feef3d89010&gt;
</code></pre>
<h3 id="working-with-query-results">Working with Query Results</h3>
<p>Now we turn to working with the results objects. So far I have demonstrated values for returning <code>sqlalchemy.CursorResult</code> objects, but additional methods are required to return the results in a usable format. The following methods are available for various purposes:</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>result.all()</code></td>
<td>return all results in query</td>
</tr>
<tr>
<td><code>result.df()</code></td>
<td>return multiple results as a dataframe</td>
</tr>
<tr>
<td><code>result.first()</code></td>
<td>return first result in query</td>
</tr>
<tr>
<td><code>result.one()</code></td>
<td>return exactly one result in query. NOTE: raises exception if not exactly one result.</td>
</tr>
<tr>
<td><code>result.scalar_one()</code></td>
<td>return single result, end query. NOTE: raises exception if not exactly one result.</td>
</tr>
<tr>
<td><code>result.scalars().all()</code></td>
<td>return single column of results</td>
</tr>
</tbody>
</table>
<pre><code class="language-python">with core.query() as q:
    r = q.select(rtab.all_cols(), limit=3)
r.all()
</code></pre>
<pre><code>2023-11-13 08:38:32,637 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:32,638 INFO sqlalchemy.engine.Engine SELECT "Record".id, "Record".age, "Record".is_old, "Record".name 
FROM "Record"
 LIMIT ? OFFSET ?
2023-11-13 08:38:32,639 INFO sqlalchemy.engine.Engine [generated in 0.00185s] (3, 0)
2023-11-13 08:38:32,640 INFO sqlalchemy.engine.Engine COMMIT





[(1, 84, 1, 'user_0'), (2, 75, 1, 'user_1'), (3, 42, 0, 'user_2')]
</code></pre>
<pre><code class="language-python">core.query().select(rtab.all_cols(), limit=3).df()
</code></pre>
<pre><code>2023-11-13 08:38:32,689 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:32,690 INFO sqlalchemy.engine.Engine SELECT "Record".id, "Record".age, "Record".is_old, "Record".name 
FROM "Record"
 LIMIT ? OFFSET ?
2023-11-13 08:38:32,690 INFO sqlalchemy.engine.Engine [cached since 0.05336s ago] (3, 0)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>age</th>
      <th>is_old</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>84</td>
      <td>1</td>
      <td>user_0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>75</td>
      <td>1</td>
      <td>user_1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>42</td>
      <td>0</td>
      <td>user_2</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># raises exception without limit=1
core.query().select(rtab.all_cols()).first()
</code></pre>
<pre><code>2023-11-13 08:38:32,740 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:32,741 INFO sqlalchemy.engine.Engine SELECT "Record".id, "Record".age, "Record".is_old, "Record".name 
FROM "Record"
2023-11-13 08:38:32,742 INFO sqlalchemy.engine.Engine [cached since 0.6331s ago] ()





(1, 84, 1, 'user_0')
</code></pre>
<pre><code class="language-python"># raises exception if more than one result is returned 
# (here I forced this with limit=1)
core.query().select(rtab.all_cols(), limit=1).one()
</code></pre>
<pre><code>2023-11-13 08:38:32,788 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:32,789 INFO sqlalchemy.engine.Engine SELECT "Record".id, "Record".age, "Record".is_old, "Record".name 
FROM "Record"
 LIMIT ? OFFSET ?
2023-11-13 08:38:32,790 INFO sqlalchemy.engine.Engine [cached since 0.1527s ago] (1, 0)





(1, 84, 1, 'user_0')
</code></pre>
<pre><code class="language-python"># this returns the first column from the first row, then closes the cursor
core.query().select(rtab.all_cols(), limit=1).scalar_one()
</code></pre>
<pre><code>2023-11-13 08:38:32,837 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:32,838 INFO sqlalchemy.engine.Engine SELECT "Record".id, "Record".age, "Record".is_old, "Record".name 
FROM "Record"
 LIMIT ? OFFSET ?
2023-11-13 08:38:32,838 INFO sqlalchemy.engine.Engine [cached since 0.2012s ago] (1, 0)





1
</code></pre>
<pre><code class="language-python"># it makes more sense to query a single column
core.query().select(rtab.cols('is_old'), limit=1).scalar_one()
</code></pre>
<pre><code>2023-11-13 08:38:32,889 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:32,890 INFO sqlalchemy.engine.Engine SELECT "Record".is_old 
FROM "Record"
 LIMIT ? OFFSET ?
2023-11-13 08:38:32,890 INFO sqlalchemy.engine.Engine [generated in 0.00136s] (1, 0)





1
</code></pre>
<pre><code class="language-python"># and when when you need a single column, use .scalars() instead of .all()
core.query().select(rtab.cols('is_old')).scalars().all()
</code></pre>
<pre><code>2023-11-13 08:38:32,940 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:32,941 INFO sqlalchemy.engine.Engine SELECT "Record".is_old 
FROM "Record"
2023-11-13 08:38:32,941 INFO sqlalchemy.engine.Engine [generated in 0.00138s] ()





[1, 1, 0, 0, 1, 0, 1, 0, 0, 1]
</code></pre>
<h3 id="conditional-select-statements">Conditional Select Statements</h3>
<table>
<thead>
<tr>
<th>operator</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&amp;</code>, <code>doctable.exp.and_()</code></td>
<td>and</td>
</tr>
<tr>
<td><code>\|</code>, <code>doctable.exp.or_()</code></td>
<td>or</td>
</tr>
<tr>
<td><code>==</code></td>
<td>equals</td>
</tr>
<tr>
<td><code>!=</code>, <code>doctable.exp.not_()</code></td>
<td>not equals</td>
</tr>
<tr>
<td><code>&gt;</code></td>
<td>greater than</td>
</tr>
<tr>
<td><code>&gt;=</code></td>
<td>greater than or equal to</td>
</tr>
<tr>
<td><code>&lt;</code></td>
<td>less than</td>
</tr>
<tr>
<td><code>&lt;=</code></td>
<td>less than or equal to</td>
</tr>
<tr>
<td><code>in_()</code></td>
<td>in list</td>
</tr>
<tr>
<td><code>contains()</code></td>
<td>check if item is substring</td>
</tr>
<tr>
<td><code>like()</code></td>
<td>like string</td>
</tr>
<tr>
<td><code>ilike()</code></td>
<td>case-insensitive like string</td>
</tr>
<tr>
<td><code>between()</code>, <code>doctable.exp.between()</code></td>
<td>between two values</td>
</tr>
<tr>
<td><code>is_()</code></td>
<td>is value</td>
</tr>
<tr>
<td><code>isnot()</code></td>
<td>is not value</td>
</tr>
<tr>
<td><code>startswith()</code></td>
<td>starts with string</td>
</tr>
</tbody>
</table>
<pre><code class="language-python">core.query().select(rtab.all_cols(), where=rtab['id']==2).df()
</code></pre>
<pre><code>2023-11-13 08:38:32,989 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:32,990 INFO sqlalchemy.engine.Engine SELECT "Record".id, "Record".age, "Record".is_old, "Record".name 
FROM "Record" 
WHERE "Record".id = ?
2023-11-13 08:38:32,990 INFO sqlalchemy.engine.Engine [generated in 0.00131s] (2,)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>age</th>
      <th>is_old</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>75</td>
      <td>1</td>
      <td>user_1</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">core.query().select(rtab.all_cols(), where=rtab['id']&lt;rtab['id']).df()
</code></pre>
<pre><code>2023-11-13 08:38:33,037 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:33,038 INFO sqlalchemy.engine.Engine SELECT "Record".id, "Record".age, "Record".is_old, "Record".name 
FROM "Record" 
WHERE "Record".id &lt; "Record".id
2023-11-13 08:38:33,038 INFO sqlalchemy.engine.Engine [generated in 0.00128s] ()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>

<pre><code class="language-python">core.query().select(rtab.all_cols(), where=(rtab['id']%2)==0).df()
</code></pre>
<pre><code>2023-11-13 08:38:33,089 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:33,090 INFO sqlalchemy.engine.Engine SELECT "Record".id, "Record".age, "Record".is_old, "Record".name 
FROM "Record" 
WHERE "Record".id % ? = ?
2023-11-13 08:38:33,091 INFO sqlalchemy.engine.Engine [generated in 0.00138s] (2, 0)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>age</th>
      <th>is_old</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>75</td>
      <td>1</td>
      <td>user_1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>25</td>
      <td>0</td>
      <td>user_3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6</td>
      <td>40</td>
      <td>0</td>
      <td>user_5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8</td>
      <td>30</td>
      <td>0</td>
      <td>user_7</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10</td>
      <td>58</td>
      <td>1</td>
      <td>user_9</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">condition = (rtab['id']&gt;=2) &amp; (rtab['id']&lt;=4) &amp; (rtab['name']!='user_2')
core.query().select(rtab.all_cols(), where=condition).df()
</code></pre>
<pre><code>2023-11-13 08:38:33,142 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:33,143 INFO sqlalchemy.engine.Engine SELECT "Record".id, "Record".age, "Record".is_old, "Record".name 
FROM "Record" 
WHERE "Record".id &gt;= ? AND "Record".id &lt;= ? AND "Record".name != ?
2023-11-13 08:38:33,143 INFO sqlalchemy.engine.Engine [generated in 0.00147s] (2, 4, 'user_2')
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>age</th>
      <th>is_old</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>75</td>
      <td>1</td>
      <td>user_1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>25</td>
      <td>0</td>
      <td>user_3</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">condition = rtab['name'].in_(('user_2','user_3'))
core.query().select(rtab.all_cols(), where=condition).df()
</code></pre>
<pre><code>2023-11-13 08:38:33,194 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:33,195 INFO sqlalchemy.engine.Engine SELECT "Record".id, "Record".age, "Record".is_old, "Record".name 
FROM "Record" 
WHERE "Record".name IN (?, ?)
2023-11-13 08:38:33,195 INFO sqlalchemy.engine.Engine [generated in 0.00146s] ('user_2', 'user_3')
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>age</th>
      <th>is_old</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3</td>
      <td>42</td>
      <td>0</td>
      <td>user_2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>25</td>
      <td>0</td>
      <td>user_3</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">core.query().select(rtab.all_cols(), where=rtab['id'].between(2,4)).df()
</code></pre>
<pre><code>2023-11-13 08:38:33,246 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:33,247 INFO sqlalchemy.engine.Engine SELECT "Record".id, "Record".age, "Record".is_old, "Record".name 
FROM "Record" 
WHERE "Record".id BETWEEN ? AND ?
2023-11-13 08:38:33,247 INFO sqlalchemy.engine.Engine [generated in 0.00134s] (2, 4)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>age</th>
      <th>is_old</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>75</td>
      <td>1</td>
      <td>user_1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>42</td>
      <td>0</td>
      <td>user_2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>25</td>
      <td>0</td>
      <td>user_3</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">condition = ~(rtab['name'].in_(('user_2','user_3'))) &amp; (rtab['id'] &lt; 4)
core.query().select(rtab.all_cols(), where=condition).df()
</code></pre>
<pre><code>2023-11-13 08:38:33,298 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:33,299 INFO sqlalchemy.engine.Engine SELECT "Record".id, "Record".age, "Record".is_old, "Record".name 
FROM "Record" 
WHERE ("Record".name NOT IN (?, ?)) AND "Record".id &lt; ?
2023-11-13 08:38:33,300 INFO sqlalchemy.engine.Engine [generated in 0.00171s] ('user_2', 'user_3', 4)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>age</th>
      <th>is_old</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>84</td>
      <td>1</td>
      <td>user_0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>75</td>
      <td>1</td>
      <td>user_1</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">condition = doctable.exp.or_(doctable.exp.not_(rtab['id']==4)) &amp; (rtab['id'] &lt;= 2)
core.query().select(rtab.all_cols(), where=condition).df()
</code></pre>
<pre><code>2023-11-13 08:38:33,350 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:33,351 INFO sqlalchemy.engine.Engine SELECT "Record".id, "Record".age, "Record".is_old, "Record".name 
FROM "Record" 
WHERE "Record".id != ? AND "Record".id &lt;= ?
2023-11-13 08:38:33,352 INFO sqlalchemy.engine.Engine [generated in 0.00181s] (4, 2)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>age</th>
      <th>is_old</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>84</td>
      <td>1</td>
      <td>user_0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>75</td>
      <td>1</td>
      <td>user_1</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">with core.query() as q:
    ages = q.select([rtab['age']]).scalars().all()
    mean_age = sum(ages)/len(ages)
    result = q.select(rtab.all_cols(), where=rtab['age']&gt;mean_age)
result.df()
</code></pre>
<pre><code>2023-11-13 08:38:33,402 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:33,404 INFO sqlalchemy.engine.Engine SELECT "Record".age 
FROM "Record"
2023-11-13 08:38:33,404 INFO sqlalchemy.engine.Engine [generated in 0.00155s] ()
2023-11-13 08:38:33,406 INFO sqlalchemy.engine.Engine SELECT "Record".id, "Record".age, "Record".is_old, "Record".name 
FROM "Record" 
WHERE "Record".age &gt; ?
2023-11-13 08:38:33,406 INFO sqlalchemy.engine.Engine [generated in 0.00045s] (53.0,)
2023-11-13 08:38:33,407 INFO sqlalchemy.engine.Engine COMMIT
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>age</th>
      <th>is_old</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>84</td>
      <td>1</td>
      <td>user_0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>75</td>
      <td>1</td>
      <td>user_1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7</td>
      <td>78</td>
      <td>1</td>
      <td>user_6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10</td>
      <td>58</td>
      <td>1</td>
      <td>user_9</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="column-operators">Column Operators</h3>
<p>In addition to any of the methods used for conditional selects, there are several additional methods that can be used to transform columns in the select statement.</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>.label()</code></td>
<td>rename column in result (particularly useful after transformations)</td>
</tr>
<tr>
<td><code>.min()</code>, <code>doctable.f.min()</code></td>
<td>max of column values</td>
</tr>
<tr>
<td><code>.max()</code>, <code>doctable.f.max()</code></td>
<td>max of column values</td>
</tr>
<tr>
<td><code>.sum()</code>, <code>doctable.f.sum()</code></td>
<td>sum of column</td>
</tr>
<tr>
<td><code>.count()</code>, <code>doctable.f.count()</code></td>
<td>count number of results. <em>NOTE</em>: must use <code>f.count()</code> when counting transformed columns.</td>
</tr>
<tr>
<td><code>.distinct()</code>, <code>doctable.f.distinct()</code></td>
<td>get distinct values</td>
</tr>
<tr>
<td><code>/</code></td>
<td>divide</td>
</tr>
<tr>
<td><code>*</code></td>
<td>multiply</td>
</tr>
<tr>
<td><code>+</code></td>
<td>add</td>
</tr>
<tr>
<td><code>-</code></td>
<td>subtract</td>
</tr>
<tr>
<td><code>%</code></td>
<td>modulo</td>
</tr>
<tr>
<td><code>.concat()</code></td>
<td>concatenate strings</td>
</tr>
</tbody>
</table>
<pre><code class="language-python">columns = [
    (rtab['id'] % 2).label('mod_id'), 
    rtab['name'].label('myname')
]
core.query().select(columns, where=rtab['is_old']).df()
</code></pre>
<pre><code>2023-11-13 08:38:33,457 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:33,458 INFO sqlalchemy.engine.Engine SELECT "Record".id % ? AS mod_id, "Record".name AS myname 
FROM "Record" 
WHERE "Record".is_old
2023-11-13 08:38:33,458 INFO sqlalchemy.engine.Engine [generated in 0.00153s] (2,)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mod_id</th>
      <th>myname</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>user_0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>user_1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>user_4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>user_6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>user_9</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">formula = rtab['age'].sum() / rtab['age'].count()
core.query().select([formula]).scalar_one()
</code></pre>
<pre><code>2023-11-13 08:38:33,510 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:33,511 INFO sqlalchemy.engine.Engine SELECT sum("Record".age) / (count("Record".age) + 0.0) AS anon_1 
FROM "Record"
2023-11-13 08:38:33,511 INFO sqlalchemy.engine.Engine [generated in 0.00153s] ()





Decimal('53.0000000000')
</code></pre>
<pre><code class="language-python">formula = rtab['age'].max() - rtab['age'].min()
core.query().select([formula]).scalar_one()
</code></pre>
<pre><code>2023-11-13 08:38:33,561 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:33,562 INFO sqlalchemy.engine.Engine SELECT max("Record".age) - min("Record".age) AS anon_1 
FROM "Record"
2023-11-13 08:38:33,563 INFO sqlalchemy.engine.Engine [generated in 0.00155s] ()





59
</code></pre>
<pre><code class="language-python"># average age of individuals over 30
formula = rtab['age'].sum() / rtab['age'].count()
condition = rtab['age'] &gt; 30
core.query().select([formula], where=condition).scalar_one()
</code></pre>
<pre><code>2023-11-13 08:38:33,614 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:33,615 INFO sqlalchemy.engine.Engine SELECT sum("Record".age) / (count("Record".age) + 0.0) AS anon_1 
FROM "Record" 
WHERE "Record".age &gt; ?
2023-11-13 08:38:33,615 INFO sqlalchemy.engine.Engine [generated in 0.00140s] (30,)





Decimal('59.3750000000')
</code></pre>
<pre><code class="language-python"># descriptive stats on age of individuals over 30
columns = [
    (rtab['age'].sum() / rtab['age'].count()).label('mean'),
    rtab['age'].max().label('max'),
    rtab['age'].min().label('min'),
]
condition = rtab['age'] &gt; 30
core.query().select(columns, where=condition).df()
</code></pre>
<pre><code>2023-11-13 08:38:33,666 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:33,667 INFO sqlalchemy.engine.Engine SELECT sum("Record".age) / (count("Record".age) + 0.0) AS mean, max("Record".age) AS max, min("Record".age) AS min 
FROM "Record" 
WHERE "Record".age &gt; ?
2023-11-13 08:38:33,667 INFO sqlalchemy.engine.Engine [generated in 0.00142s] (30,)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>max</th>
      <th>min</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>59.3750000000</td>
      <td>84</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># all distinct values
formula = rtab['is_old'].distinct()
core.query().select([formula]).df()
</code></pre>
<pre><code>2023-11-13 08:38:33,717 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:33,718 INFO sqlalchemy.engine.Engine SELECT distinct("Record".is_old) AS distinct_1 
FROM "Record"
2023-11-13 08:38:33,718 INFO sqlalchemy.engine.Engine [generated in 0.00171s] ()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>distinct_1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># count individuals over 30
core.query().select([doctable.f.count()], where=rtab['age']&gt;30).scalar_one()
</code></pre>
<pre><code>2023-11-13 08:38:33,765 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:33,766 INFO sqlalchemy.engine.Engine SELECT count(*) AS count_1 
FROM "Record" 
WHERE "Record".age &gt; ?
2023-11-13 08:38:33,767 INFO sqlalchemy.engine.Engine [generated in 0.00157s] (30,)





8
</code></pre>
<pre><code class="language-python"># similar to previous
core.query().select([rtab['id'].count()], where=rtab['age']&gt;30).scalar_one()
</code></pre>
<pre><code>2023-11-13 08:38:33,817 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:33,818 INFO sqlalchemy.engine.Engine SELECT count("Record".id) AS count_1 
FROM "Record" 
WHERE "Record".age &gt; ?
2023-11-13 08:38:33,818 INFO sqlalchemy.engine.Engine [generated in 0.00127s] (30,)





8
</code></pre>
<h3 id="additional-parameters-order-by-group-by-limit-offset">Additional Parameters: Order By, Group By, Limit, Offset</h3>
<p>More complicated queries involving ordering, grouping, limiting, and specifying offset can be specified using parameters to the <code>.select()</code> method.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>limit</code></td>
<td>limit number of results</td>
</tr>
<tr>
<td><code>order_by</code></td>
<td>list of columns to order by</td>
</tr>
<tr>
<td><code>group_by</code></td>
<td>list of columns to group by</td>
</tr>
<tr>
<td><code>offset</code></td>
<td>offset results by specified number</td>
</tr>
</tbody>
</table>
<h4 id="order-by-and-limits">Order By and Limits</h4>
<pre><code class="language-python"># get the five youngest individuals in order
core.query().select(rtab.all_cols(), order_by=rtab['age'], limit=5).df()
</code></pre>
<pre><code>2023-11-13 08:38:33,865 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:33,865 INFO sqlalchemy.engine.Engine SELECT "Record".id, "Record".age, "Record".is_old, "Record".name 
FROM "Record" ORDER BY "Record".age
 LIMIT ? OFFSET ?
2023-11-13 08:38:33,866 INFO sqlalchemy.engine.Engine [generated in 0.00127s] (5, 0)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>age</th>
      <th>is_old</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>25</td>
      <td>0</td>
      <td>user_3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8</td>
      <td>30</td>
      <td>0</td>
      <td>user_7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6</td>
      <td>40</td>
      <td>0</td>
      <td>user_5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>42</td>
      <td>0</td>
      <td>user_2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9</td>
      <td>47</td>
      <td>0</td>
      <td>user_8</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># get the five oldest now
core.query().select(rtab.all_cols(), order_by=rtab['age'].desc(), limit=5).df()
</code></pre>
<pre><code>2023-11-13 08:38:33,913 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:33,914 INFO sqlalchemy.engine.Engine SELECT "Record".id, "Record".age, "Record".is_old, "Record".name 
FROM "Record" ORDER BY "Record".age DESC
 LIMIT ? OFFSET ?
2023-11-13 08:38:33,915 INFO sqlalchemy.engine.Engine [generated in 0.00165s] (5, 0)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>age</th>
      <th>is_old</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>84</td>
      <td>1</td>
      <td>user_0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7</td>
      <td>78</td>
      <td>1</td>
      <td>user_6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>75</td>
      <td>1</td>
      <td>user_1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10</td>
      <td>58</td>
      <td>1</td>
      <td>user_9</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>51</td>
      <td>1</td>
      <td>user_4</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># order by is_old, but preserve order of id otherwise
order = [
    rtab['is_old'].desc(),
    rtab['id'].asc(),
]
core.query().select(rtab.all_cols(), order_by=order, limit=5).df()
</code></pre>
<pre><code>2023-11-13 08:38:33,965 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:33,966 INFO sqlalchemy.engine.Engine SELECT "Record".id, "Record".age, "Record".is_old, "Record".name 
FROM "Record" ORDER BY "Record".is_old DESC, "Record".id ASC
 LIMIT ? OFFSET ?
2023-11-13 08:38:33,966 INFO sqlalchemy.engine.Engine [generated in 0.00135s] (5, 0)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>age</th>
      <th>is_old</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>84</td>
      <td>1</td>
      <td>user_0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>75</td>
      <td>1</td>
      <td>user_1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>51</td>
      <td>1</td>
      <td>user_4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7</td>
      <td>78</td>
      <td>1</td>
      <td>user_6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10</td>
      <td>58</td>
      <td>1</td>
      <td>user_9</td>
    </tr>
  </tbody>
</table>
</div>

<h4 id="grouping-and-column-operators">Grouping and Column Operators</h4>
<pre><code class="language-python"># summary stats by is_old
cols = [
    #rtab['is_old'].count().label('count'),
    doctable.f.count().label('count'),
    rtab['age'].min().label('min'),
    rtab['age'].max().label('max'),
    (rtab['age'].sum()/rtab['age'].count()).label('mean'),
]
core.query().select(cols, group_by=rtab['is_old']).df()
</code></pre>
<pre><code>2023-11-13 08:38:34,018 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:34,019 INFO sqlalchemy.engine.Engine SELECT count(*) AS count, min("Record".age) AS min, max("Record".age) AS max, sum("Record".age) / (count("Record".age) + 0.0) AS mean 
FROM "Record" GROUP BY "Record".is_old
2023-11-13 08:38:34,019 INFO sqlalchemy.engine.Engine [generated in 0.00141s] ()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>min</th>
      <th>max</th>
      <th>mean</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5</td>
      <td>25</td>
      <td>47</td>
      <td>36.8000000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5</td>
      <td>51</td>
      <td>84</td>
      <td>69.2000000000</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># summarize age by decade
decade_expression = doctable.f.round(rtab['age'] / 10)
cols = [
    decade_expression.label('decade'),
    rtab['age'].count().label('count'),
    rtab['age'].min().label('min'),
    rtab['age'].max().label('max'),
    (rtab['age'].sum()/rtab['age'].count()).label('mean'),
]
core.query().select(cols, group_by=decade_expression).df()
</code></pre>
<pre><code>2023-11-13 08:38:34,070 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:34,071 INFO sqlalchemy.engine.Engine SELECT round("Record".age / (? + 0.0)) AS decade, count("Record".age) AS count, min("Record".age) AS min, max("Record".age) AS max, sum("Record".age) / (count("Record".age) + 0.0) AS mean 
FROM "Record" GROUP BY round("Record".age / (? + 0.0))
2023-11-13 08:38:34,072 INFO sqlalchemy.engine.Engine [generated in 0.00134s] (10, 10)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>decade</th>
      <th>count</th>
      <th>min</th>
      <th>max</th>
      <th>mean</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.0</td>
      <td>2</td>
      <td>25</td>
      <td>30</td>
      <td>27.5000000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.0</td>
      <td>2</td>
      <td>40</td>
      <td>42</td>
      <td>41.0000000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5.0</td>
      <td>2</td>
      <td>47</td>
      <td>51</td>
      <td>49.0000000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6.0</td>
      <td>1</td>
      <td>58</td>
      <td>58</td>
      <td>58.0000000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8.0</td>
      <td>3</td>
      <td>75</td>
      <td>84</td>
      <td>79.0000000000</td>
    </tr>
  </tbody>
</table>
</div>

<h4 id="offset-and-selecting-chunks">Offset and Selecting Chunks</h4>
<p>The <code>offset</code> parameter is used to pagify results into multiple queries - something that is particularly useful if the result set is too larget to fit into memory.</p>
<pre><code class="language-python"># get the three oldest individuals, offset by three
core.query().select(rtab.all_cols(), order_by=rtab['age'].desc(), limit=3, offset=3).df()
</code></pre>
<pre><code>2023-11-13 08:38:34,121 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:34,121 INFO sqlalchemy.engine.Engine SELECT "Record".id, "Record".age, "Record".is_old, "Record".name 
FROM "Record" ORDER BY "Record".age DESC
 LIMIT ? OFFSET ?
2023-11-13 08:38:34,122 INFO sqlalchemy.engine.Engine [generated in 0.00137s] (3, 3)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>age</th>
      <th>is_old</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>58</td>
      <td>1</td>
      <td>user_9</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5</td>
      <td>51</td>
      <td>1</td>
      <td>user_4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9</td>
      <td>47</td>
      <td>0</td>
      <td>user_8</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">for chunk in core.query().select_chunks(rtab.all_cols(), chunksize=3):
    print(chunk)
</code></pre>
<pre><code>2023-11-13 08:38:34,169 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:34,169 INFO sqlalchemy.engine.Engine SELECT "Record".id, "Record".age, "Record".is_old, "Record".name 
FROM "Record"
 LIMIT ? OFFSET ?
2023-11-13 08:38:34,170 INFO sqlalchemy.engine.Engine [generated in 0.00117s] (3, 0)
[(1, 84, 1, 'user_0'), (2, 75, 1, 'user_1'), (3, 42, 0, 'user_2')]
2023-11-13 08:38:34,171 INFO sqlalchemy.engine.Engine SELECT "Record".id, "Record".age, "Record".is_old, "Record".name 
FROM "Record"
 LIMIT ? OFFSET ?
2023-11-13 08:38:34,171 INFO sqlalchemy.engine.Engine [cached since 0.002855s ago] (3, 3)
[(4, 25, 0, 'user_3'), (5, 51, 1, 'user_4'), (6, 40, 0, 'user_5')]
2023-11-13 08:38:34,172 INFO sqlalchemy.engine.Engine SELECT "Record".id, "Record".age, "Record".is_old, "Record".name 
FROM "Record"
 LIMIT ? OFFSET ?
2023-11-13 08:38:34,173 INFO sqlalchemy.engine.Engine [cached since 0.004328s ago] (3, 6)
[(7, 78, 1, 'user_6'), (8, 30, 0, 'user_7'), (9, 47, 0, 'user_8')]
2023-11-13 08:38:34,175 INFO sqlalchemy.engine.Engine SELECT "Record".id, "Record".age, "Record".is_old, "Record".name 
FROM "Record"
 LIMIT ? OFFSET ?
2023-11-13 08:38:34,175 INFO sqlalchemy.engine.Engine [cached since 0.006853s ago] (3, 9)
[(10, 58, 1, 'user_9')]
</code></pre>
<h2 id="tablequery-basics"><code>TableQuery</code> Basics</h2>
<p>The <code>TableQuery</code> interface is used to make table-specific queries, and, in exchange for this restriction, allows you to insert and select container objects directly. Queries on tables look much like their table-agnostic counterparts, with a few exceptions. Every query still begins with the <code>.query()</code> method, which returns a <code>TableQuery</code> object with methods for inserting and selecting container objects.</p>
<ol>
<li>
<p>List of selected columns is optional - if you do not specify, the query will default to all columns in the table. Otherwise, you should provide a subset of the columns, where all attributes that were not received will refer to <code>doctable.MISSING</code>, which you may check for downstream.</p>
</li>
<li>
<p>Results of a select query are returned as a list of container objects. This means that we have called the <code>.all()</code> method on the <code>sqlalchemy.CursorResult</code> object.</p>
</li>
<li>
<p>All returned results must match the attributes of the container object. Most often you will want to select raw database rows, but transformations via <code>group_by</code> and other operators are also possible as long as the result set attributes match the container attributes - that is, they can be expanded to the container constructor.</p>
</li>
<li>
<p>Behavior of <code>where</code>, <code>order_by</code>, <code>limit</code>, are <code>offset</code> all operate as-expected.</p>
</li>
</ol>
<p>Below you can see a few examples demonstrating this behavior.</p>
<pre><code class="language-python">rtab.query().select(where=rtab['age']&gt;50)
</code></pre>
<pre><code>2023-11-13 08:38:34,217 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:34,218 INFO sqlalchemy.engine.Engine SELECT "Record".id, "Record".age, "Record".is_old, "Record".name 
FROM "Record" 
WHERE "Record".age &gt; ?
2023-11-13 08:38:34,219 INFO sqlalchemy.engine.Engine [generated in 0.00128s] (50,)





[Record(name='user_0', age=84, is_old=1, id=1),
 Record(name='user_1', age=75, is_old=1, id=2),
 Record(name='user_4', age=51, is_old=1, id=5),
 Record(name='user_6', age=78, is_old=1, id=7),
 Record(name='user_9', age=58, is_old=1, id=10)]
</code></pre>
<pre><code class="language-python">result = rtab.query().select(rtab.cols('id', 'age'), where=rtab['is_old'])
f'{result[0].name is doctable.MISSING=}', result
</code></pre>
<pre><code>2023-11-13 08:38:34,268 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:34,269 INFO sqlalchemy.engine.Engine SELECT "Record".id, "Record".age 
FROM "Record" 
WHERE "Record".is_old
2023-11-13 08:38:34,270 INFO sqlalchemy.engine.Engine [generated in 0.00134s] ()





('result[0].name is doctable.MISSING=True',
 [Record(name=MISSING, age=84, is_old=MISSING, id=1),
  Record(name=MISSING, age=75, is_old=MISSING, id=2),
  Record(name=MISSING, age=51, is_old=MISSING, id=5),
  Record(name=MISSING, age=78, is_old=MISSING, id=7),
  Record(name=MISSING, age=58, is_old=MISSING, id=10)])
</code></pre>
<pre><code class="language-python"># this is valid, although perhaps not recommended
cols = [
    (rtab['age'].sum()/rtab['age'].count()).label('age'),
]
rtab.query().select(cols=cols)
</code></pre>
<pre><code>2023-11-13 08:38:34,317 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:34,318 INFO sqlalchemy.engine.Engine SELECT sum("Record".age) / (count("Record".age) + 0.0) AS age 
FROM "Record"
2023-11-13 08:38:34,318 INFO sqlalchemy.engine.Engine [generated in 0.00123s] ()





[Record(name=MISSING, age=Decimal('53.0000000000'), is_old=MISSING, id=MISSING)]
</code></pre>
<p><code>.select_chunks()</code> also more or less works as-expected, with the chunks being converted to container objects.</p>
<pre><code class="language-python">for chunk in rtab.query().select_chunks(chunksize=3):
    print(chunk)
</code></pre>
<pre><code>2023-11-13 08:38:34,364 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2023-11-13 08:38:34,365 INFO sqlalchemy.engine.Engine SELECT "Record".id, "Record".age, "Record".is_old, "Record".name 
FROM "Record"
 LIMIT ? OFFSET ?
2023-11-13 08:38:34,365 INFO sqlalchemy.engine.Engine [cached since 0.1964s ago] (3, 0)
[Record(name='user_0', age=84, is_old=1, id=1), Record(name='user_1', age=75, is_old=1, id=2), Record(name='user_2', age=42, is_old=0, id=3)]
2023-11-13 08:38:34,366 INFO sqlalchemy.engine.Engine SELECT "Record".id, "Record".age, "Record".is_old, "Record".name 
FROM "Record"
 LIMIT ? OFFSET ?
2023-11-13 08:38:34,367 INFO sqlalchemy.engine.Engine [cached since 0.198s ago] (3, 3)
[Record(name='user_3', age=25, is_old=0, id=4), Record(name='user_4', age=51, is_old=1, id=5), Record(name='user_5', age=40, is_old=0, id=6)]
2023-11-13 08:38:34,368 INFO sqlalchemy.engine.Engine SELECT "Record".id, "Record".age, "Record".is_old, "Record".name 
FROM "Record"
 LIMIT ? OFFSET ?
2023-11-13 08:38:34,368 INFO sqlalchemy.engine.Engine [cached since 0.1994s ago] (3, 6)
[Record(name='user_6', age=78, is_old=1, id=7), Record(name='user_7', age=30, is_old=0, id=8), Record(name='user_8', age=47, is_old=0, id=9)]
2023-11-13 08:38:34,369 INFO sqlalchemy.engine.Engine SELECT "Record".id, "Record".age, "Record".is_old, "Record".name 
FROM "Record"
 LIMIT ? OFFSET ?
2023-11-13 08:38:34,369 INFO sqlalchemy.engine.Engine [cached since 0.2007s ago] (3, 9)
[Record(name='user_9', age=58, is_old=1, id=10)]
</code></pre>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.6c14ae12.min.js"></script>
      
    
  </body>
</html>